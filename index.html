import React, { useState, useEffect } from "react";
import { motion } from "framer-motion";
import { Menu, X, Mail, Phone, MapPin, Github, Linkedin, ExternalLink, Code2, User, Briefcase } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";

/**
 * IMPORTANT
 * ----------
 * You said: "make it the same as the link". Please paste the reference link
 * and I will mirror the exact layout, colors, and components. This starter
 * matches common modern portfolio patterns and is structured so I can quickly
 * swap styles once I see the reference site.
 */

/**
 * THEME – quick color switches to match the reference later
 */
const theme = {
  brand: {
    bg: "from-[#0F172A] via-[#0B1220] to-black", // hero gradient
    primary: "#5EA1FA", // accents, links, buttons
    primaryHover: "#4B8EE6",
    surface: "#0B1220",
    text: "#E6E6E6",
    subtext: "#A3A3A3",
    card: "#0F172A",
    ring: "#5EA1FA",
  },
};

/**
 * Demo portfolio data – replace with your real projects once we have the link
 */
const PROJECTS = [
  {
    title: "SaaS Dashboard",
    tags: ["React", "Tailwind", "Charts"],
    description: "A responsive analytics dashboard with auth and theming.",
    url: "#",
  },
  {
    title: "E‑commerce Store",
    tags: ["Next.js", "Stripe", "SSR"],
    description: "Full‑stack store with payments and CMS integration.",
    url: "#",
  },
  {
    title: "Portfolio Revamp",
    tags: ["UI/UX", "Framer Motion"],
    description: "Micro‑interactions, page transitions, and case studies.",
    url: "#",
  },
  {
    title: "API Toolkit",
    tags: ["Node", "REST", "Docs"],
    description: "Developer‑friendly endpoints with auto‑generated docs.",
    url: "#",
  },
];

const sections = [
  { id: "home", label: "Home", icon: <Code2 className="w-4 h-4" /> },
  { id: "about", label: "About", icon: <User className="w-4 h-4" /> },
  { id: "portfolio", label: "Portfolio", icon: <Briefcase className="w-4 h-4" /> },
  { id: "contact", label: "Contact", icon: <Mail className="w-4 h-4" /> },
];

function useScrollSpy(ids) {
  const [active, setActive] = useState(ids[0]);
  useEffect(() => {
    const handler = () => {
      const offsets = ids.map((id) => {
        const el = document.getElementById(id);
        if (!el) return { id, top: Infinity };
        const rect = el.getBoundingClientRect();
        return { id, top: Math.abs(rect.top) };
      });
      offsets.sort((a, b) => a.top - b.top);
      setActive(offsets[0].id);
    };
    handler();
    window.addEventListener("scroll", handler, { passive: true });
    return () => window.removeEventListener("scroll", handler);
  }, [ids]);
  return active;
}

export default function PortfolioSite() {
  const [open, setOpen] = useState(false);
  const active = useScrollSpy(sections.map((s) => s.id));

  const scrollTo = (id) => {
    const el = document.getElementById(id);
    if (el) el.scrollIntoView({ behavior: "smooth", block: "start" });
    setOpen(false);
  };

  return (
    <div className={`min-h-screen text-[${theme.brand.text}] bg-gradient-to-b ${theme.brand.bg}`}>      
      {/* NAVBAR */}
      <header className="sticky top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-white/5 bg-black/20 border-b border-white/10">
        <div className="mx-auto max-w-6xl px-4">
          <div className="h-16 flex items-center justify-between">
            <div className="flex items-center gap-2">
              <div className="w-8 h-8 rounded-xl bg-white/10 grid place-items-center">⚡</div>
              <span className="font-semibold tracking-tight">Your Name</span>
            </div>

            <nav className="hidden md:flex items-center gap-1">
              {sections.map((s) => (
                <Button
                  key={s.id}
                  variant="ghost"
                  className={`text-sm data-[active=true]:bg-white/10 data-[active=true]:text-white rounded-xl px-3 ${active === s.id ? "bg-white/10" : "text-white/80"}`}
                  data-active={active === s.id}
                  onClick={() => scrollTo(s.id)}
                >
                  <span className="mr-2 hidden sm:inline">{s.label}</span>
                </Button>
              ))}
              <a href="#contact">
                <Button className="rounded-xl bg-[var(--btn)]" style={{
                  backgroundColor: theme.brand.primary,
                }}>Hire Me</Button>
              </a>
            </nav>

            <button className="md:hidden p-2 rounded-xl hover:bg-white/10" onClick={() => setOpen(!open)} aria-label="Toggle menu">
              {open ? <X /> : <Menu />}
            </button>
          </div>
        </div>
        {open && (
          <div className="md:hidden border-t border-white/10">
            <div className="mx-auto max-w-6xl px-4 py-2 grid gap-2">
              {sections.map((s) => (
                <button
                  key={s.id}
                  onClick={() => scrollTo(s.id)}
                  className={`text-left px-3 py-2 rounded-xl hover:bg-white/10 ${active === s.id ? "bg-white/10" : ""}`}
                >
                  {s.label}
                </button>
              ))}
            </div>
          </div>
        )}
      </header>

      {/* HERO / HOME */}
      <section id="home" className="relative overflow-hidden">
        <div className="mx-auto max-w-6xl px-4 py-20 md:py-28">
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            whileInView={{ opacity: 1, y: 0 }}
            viewport={{ once: true }}
            transition={{ duration: 0.6 }}
            className="grid md:grid-cols-2 gap-8 items-center"
          >
            <div>
              <div className="inline-flex items-center gap-2 bg-white/5 border border-white/10 rounded-full px-3 py-1 text-xs mb-5">
                <span className="h-2 w-2 rounded-full" style={{ backgroundColor: theme.brand.primary }} />
                Available for freelance work
              </div>
              <h1 className="text-4xl md:text-6xl font-bold leading-tight">
                Building clean, fast & delightful web experiences.
              </h1>
              <p className="mt-4 text-white/70 max-w-prose">
                I design and develop modern websites and apps with a focus on performance,
                accessibility, and animations that feel just right.
              </p>
              <div className="mt-8 flex flex-wrap gap-3">
                <Button onClick={() => scrollTo("portfolio")} className="rounded-xl px-5 py-6" style={{ backgroundColor: theme.brand.primary }}>
                  View Work
                </Button>
                <Button variant="outline" className="rounded-xl px-5 py-6 border-white/20 text-white/80 hover:bg-white/5" onClick={() => scrollTo("contact")}>
                  Contact Me
                </Button>
              </div>
            </div>
            <motion.div
              initial={{ opacity: 0, scale: 0.95 }}
              whileInView={{ opacity: 1, scale: 1 }}
              viewport={{ once: true }}
              transition={{ duration: 0.6, delay: 0.1 }}
              className="relative"
            >
              <div className="aspect-[4/3] rounded-2xl border border-white/10 bg-gradient-to-br from-white/10 to-white/5 shadow-2xl" />
              <div className="absolute -bottom-6 -left-6 w-24 h-24 rounded-2xl bg-white/10 blur-2xl" />
              <div className="absolute -top-4 -right-4 w-24 h-24 rounded-full bg-white/10 blur-2xl" />
            </motion.div>
          </motion.div>
        </div>
      </section>

      {/* ABOUT */}
      <section id="about" className="py-20 border-t border-white/10 bg-black/10">
        <div className="mx-auto max-w-6xl px-4">
          <motion.div initial={{ opacity: 0, y: 20 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
            <div className="mb-10">
              <h2 className="text-3xl md:text-4xl font-semibold">About Me</h2>
              <p className="mt-3 text-white/70 max-w-2xl">
                I’m a frontend‑leaning full‑stack developer who cares about design systems,
                smooth motion, and inclusive UX. Over the past years I’ve delivered SaaS,
                e‑commerce, and content sites for startups and agencies.
              </p>
            </div>

            <div className="grid md:grid-cols-3 gap-6">
              {["Frontend", "Backend", "Tooling"].map((group, i) => (
                <Card key={group} className="rounded-2xl border-white/10 bg-white/5">
                  <CardHeader>
                    <CardTitle className="text-white/90">{group}</CardTitle>
                  </CardHeader>
                  <CardContent className="text-white/70">
                    {i === 0 && <ul className="space-y-1 list-disc list-inside">
                      <li>React, Next.js</li>
                      <li>Tailwind, shadcn/ui</li>
                      <li>Framer Motion</li>
                    </ul>}
                    {i === 1 && <ul className="space-y-1 list-disc list-inside">
                      <li>Node, Express</li>
                      <li>Postgres, Prisma</li>
                      <li>Auth, REST</li>
                    </ul>}
                    {i === 2 && <ul className="space-y-1 list-disc list-inside">
                      <li>TypeScript, ESLint</li>
                      <li>Vite, Turborepo</li>
                      <li>CI/CD, Testing</li>
                    </ul>}
                  </CardContent>
                </Card>
              ))}
            </div>
          </motion.div>
        </div>
      </section>

      {/* PORTFOLIO */}
      <section id="portfolio" className="py-20">
        <div className="mx-auto max-w-6xl px-4">
          <div className="mb-10 flex items-end justify-between gap-4 flex-wrap">
            <div>
              <h2 className="text-3xl md:text-4xl font-semibold">Portfolio</h2>
              <p className="mt-2 text-white/70">Selected work and case studies.</p>
            </div>
            <div className="flex gap-2">
              <FilterPills />
            </div>
          </div>

          <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
            {PROJECTS.map((p, idx) => (
              <motion.a
                key={p.title}
                href={p.url}
                target="_blank"
                rel="noreferrer"
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ duration: 0.4, delay: idx * 0.05 }}
                className="group"
              >
                <Card className="rounded-2xl overflow-hidden border-white/10 bg-white/5 hover:bg-white/[0.07] transition">
                  <div className="aspect-video bg-gradient-to-br from-white/15 to-white/5" />
                  <CardHeader className="pb-0">
                    <CardTitle className="flex items-center justify-between text-white/90">
                      {p.title}
                      <ExternalLink className="w-4 h-4 opacity-70 group-hover:opacity-100" />
                    </CardTitle>
                  </CardHeader>
                  <CardContent className="text-white/70">
                    <p className="text-sm">{p.description}</p>
                    <div className="mt-2 flex flex-wrap gap-2 text-xs">
                      {p.tags.map((t) => (
                        <span key={t} className="px-2 py-1 rounded-full bg-white/10 border border-white/10">{t}</span>
                      ))}
                    </div>
                  </CardContent>
                </Card>
              </motion.a>
            ))}
          </div>
        </div>
      </section>

      {/* CONTACT */}
      <section id="contact" className="py-20 border-t border-white/10 bg-black/10">
        <div className="mx-auto max-w-6xl px-4">
          <div className="mb-10">
            <h2 className="text-3xl md:text-4xl font-semibold">Get in touch</h2>
            <p className="mt-2 text-white/70">Have a project in mind? Let’s chat.</p>
          </div>

          <div className="grid md:grid-cols-3 gap-6">
            <Card className="rounded-2xl border-white/10 bg-white/5">
              <CardContent className="p-6 text-white/80 space-y-4">
                <ContactRow icon={<Mail className="w-4 h-4" />} label="Email" value="you@example.com" href="mailto:you@example.com" />
                <ContactRow icon={<Phone className="w-4 h-4" />} label="Phone" value="+1 234 567 890" href="tel:+1234567890" />
                <ContactRow icon={<MapPin className="w-4 h-4" />} label="Location" value="Your City, Country" />
                <div className="pt-4 flex gap-3">
                  <IconLink href="#" label="GitHub">
                    <Github className="w-5 h-5" />
                  </IconLink>
                  <IconLink href="#" label="LinkedIn">
                    <Linkedin className="w-5 h-5" />
                  </IconLink>
                </div>
              </CardContent>
            </Card>

            <Card className="md:col-span-2 rounded-2xl border-white/10 bg-white/5">
              <CardContent className="p-6">
                <form onSubmit={(e) => e.preventDefault()} className="grid gap-4">
                  <div className="grid md:grid-cols-2 gap-4">
                    <Input placeholder="Your name" className="bg-white/5 border-white/10 text-white placeholder:text-white/40" />
                    <Input type="email" placeholder="Your email" className="bg-white/5 border-white/10 text-white placeholder:text-white/40" />
                  </div>
                  <Input placeholder="Subject" className="bg-white/5 border-white/10 text-white placeholder:text-white/40" />
                  <Textarea placeholder="Your message" className="min-h-[140px] bg-white/5 border-white/10 text-white placeholder:text-white/40" />
                  <Button type="submit" className="rounded-xl self-start" style={{ backgroundColor: theme.brand.primary }}>Send Message</Button>
                </form>
              </CardContent>
            </Card>
          </div>
        </div>
      </section>

      <footer className="py-10 text-center text-white/50 border-t border-white/10">
        <div className="mx-auto max-w-6xl px-4">
          © {new Date().getFullYear()} Your Name. All rights reserved.
        </div>
      </footer>
    </div>
  );
}

function ContactRow({ icon, label, value, href }) {
  const Wrapper = href ? "a" : "div";
  return (
    <Wrapper href={href} className="flex items-center gap-3">
      <div className="w-9 h-9 rounded-xl bg-white/10 grid place-items-center border border-white/10">{icon}</div>
      <div>
        <div className="text-xs text-white/50">{label}</div>
        <div className="text-sm">{value}</div>
      </div>
    </Wrapper>
  );
}

function IconLink({ href, children, label }) {
  return (
    <a
      href={href}
      target="_blank"
      rel="noreferrer"
      aria-label={label}
      className="p-2 rounded-xl border border-white/10 hover:bg-white/10"
    >
      {children}
    </a>
  );
}

function FilterPills() {
  const [active, setActive] = useState("All");
  const pills = ["All", "Frontend", "Backend", "UI/UX"];
  return (
    <div className="flex flex-wrap gap-2">
      {pills.map((p) => (
        <button
          key={p}
          onClick={() => setActive(p)}
          className={`px-3 py-1.5 rounded-full border border-white/10 text-sm ${
            active === p ? "bg-white/15" : "hover:bg-white/10"
          }`}
        >
          {p}
        </button>
      ))}
    </div>
  );
}
